# fly.worker.toml
app = "mailscout-worker"
primary_region = "bom"
kill_signal = "SIGINT"
kill_timeout = 5

[build]
  builder = "heroku/buildpacks:20"

[env]
  QUEUE_KEY = "mailscout:jobs"
  CONCURRENCY = "100"
  PER_MX_LIMIT = "5"
  INSERT_BATCH_SIZE = "200"

[experimental]
  auto_rollback = false

# ---------------------------------------------------------
# WORKERS DO NOT EXPOSE ANY NETWORK SERVICES
# ---------------------------------------------------------
# Remove all [[services]] and [http_service] blocks.
# Workers are background processes only.
# ---------------------------------------------------------

[processes]
  worker = "python -m app.worker"

[[vm]]
  cpu_kind = "shared"
  cpus = 1
  memory = "1gb"
